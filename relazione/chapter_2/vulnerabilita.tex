% Secondo capitolo
\subsection{SQL Injection}
L'\textbf{SQL Injection}(SQLI) \`e una techinca di code injection utilizzata per attaccare applicazioni o servizi basati sui dati. Con questo tipo di attacco si possono estrarre da un database diversi tipi di informazioni sensibili come ad esempio, i dati personali di tutti gli utenti oppure i dati per l'autenticazione al sistema che si sta attaccando.

Nel nostro progetto l'SQLI \`e usata per due funzioni: la prima per accedere come amministratore, la seconda, per prendere le credenziali, sia username che password, di tutti gli utenti registrati nel sito.

Ora, analizzeremo come vengono realizzate le due funzioni appena descritte. Per prima cosa, in entrabi gli attacchi, si deve entrare nella pagina di login del nostro sito(Fig. \ref{fig:home}).

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.3]{foto/site-home.png}
	\caption{Home page del sito.}
	\label{fig:home}
\end{figure}
%\newpage

Per prendere i diritti da amministratore nel nostro sito tramite SQLI, basta sapere l'username che utilizza per l'autenticazione il vero admin aggiungendo tre caratteri del linguaggio php con cui di norma si scrivono le query. In particolare, la query che viene inviata al databasae per prendere i dati \'e:

\begin{lstlisting}

SELECT * 
FROM users 
WHERE (username LIKE '$username') AND (password = '$password)

\end{lstlisting}

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.5]{foto/login-page-admin.png}
	\caption{SQLI per diventare admin.}
	\label{fig:admin-login}
\end{figure}
%\newpage

La query viene modificata con i caratteri che in figura(Fig. \ref{fig:admin-login}) sono evidenziati in rosso, in quanto la modificano in questa:

\begin{lstlisting}

SELECT * 
FROM users 
WHERE (username LIKE '$username')

\end{lstlisting}

Ci\`o \`e possibile poich\'e l'ultimo carattere inserito nel form dedicato all'inserimento dell'username, commenta la parte successiva della query, raggirando il controllo sulla password.

La seconda vulnerabili\`a che si pu\`o sfruttare nel sito, tramite SQLI, permette di ottenere tutti i dati presenti nel database del sito, in particolare quelli utilizzati dagli utenti per l'autenticazione.

Per eseguire questo attacco, bisogna essere all'interno della propria pagina dashboard, che viene aperta dopo una corretta autenticazione(Fig. \ref{fig:dashboard-john-no-query}).

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.3]{foto/dashboard-john-no-query.png}
	\caption{Home page del sito.}
	\label{fig:dashboard-john-no-query}
\end{figure}
\newpage

Poi, si inserisce nel form di ricerca la seguente stringa:

\begin{lstlisting}

' or 1=1 union all select 1,2, concat (username, " ", password) from users#

\end{lstlisting}

Questi caratteri vanno a modificare la query per la ricerca:

\begin{lstlisting}

SELECT * 
FROM stranger_things 
WHERE thing = ' or 1=1 union all select 1,2, 
	CONCAT (username, " ", password) 
	FROM users#

\end{lstlisting}

%un utente maleitenzionato deve inserire del codice che modifichi la corretta eseguzione del programma che si sta attaccando cos√¨