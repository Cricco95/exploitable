% Secondo capitolo
\subsection{SQL Injection}
L'\textbf{SQL Injection} (SQLI) è una tecnica di code injection utilizzata per attaccare applicazioni o servizi basati su database relazionali. Con questo tipo di attacco si possono estrarre da un database diversi tipi di informazioni sensibili, come ad esempio i dati personali di tutti gli utenti oppure i dati per l'autenticazione al sistema che si sta attaccando.

Nel nostro progetto l'SQLi è usata per due funzioni: la prima per accedere come amministratore, la seconda per estrarre le credenziali, sia username che hash di password, di tutti gli utenti registrati nel sito.

Ora analizzeremo come vengono realizzate le due funzioni appena descritte: per prima cosa, in entrambi gli attacchi si deve entrare nella pagina di login del nostro sito (Fig. \ref{fig:home}).

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{foto/site-home.png}
	\caption{Home page del sito.}
	\label{fig:home}
\end{figure}

Per ottenere i diritti da amministratore del sito web, basta conoscere l'username che utilizza per l'autenticazione l'amministratore aggiungendo solamente tre caratteri del linguaggio SQL con cui di norma si scrivono le query. In particolare la query che viene inviata al database per autenticare un utente è la seguente:

\begin{lstlisting}
SELECT * 
FROM users 
WHERE (username LIKE '$username') AND (password = '$password)
\end{lstlisting}

\begin{figure}[h]
	\centering
	\includegraphics[width=\textwidth]{foto/login-page-admin.png}
	\caption{SQLI per diventare admin.}
	\label{fig:admin-login}
\end{figure}
%\newpage

La query viene modificata con i caratteri che in figura (Fig. \ref{fig:admin-login}) sono evidenziati in rosso, in quanto la modificano in questa:

\begin{lstlisting}
SELECT * 
FROM users 
WHERE (username LIKE 'admin')
\end{lstlisting}

Ciò è possibile poiché l'ultimo carattere inserito nel form dedicato all'inserimento dell'username commenta la parte successiva della query, raggirando il controllo sulla password.

La seconda vulnerabilità che si può sfruttare nel sito,sempre tramite SQLi, permette di ottenere tutti i dati presenti nel database, in particolare quelli utilizzati dagli utenti per l'autenticazione.

Per eseguire questo attacco, bisogna essere all'interno della propria dashboard, che viene aperta dopo una corretta autenticazione (Fig. \ref{fig:dashboard-john-no-query}).

\begin{figure}[h]
	\centering
	\includegraphics[width=\textwidth]{foto/dashboard-john-no-query.png}
	\caption{Dashboard dell'utente.}
	\label{fig:dashboard-john-no-query}
\end{figure}
\newpage

Poi si inserisce nel form di ricerca la seguente stringa:

\begin{lstlisting}
' OR 1=1 UNION ALL SELECT 1,2,CONCAT (username, " ", password) FROM users#
\end{lstlisting}

Questi caratteri vanno a modificare la query per la ricerca:

\begin{lstlisting}
SELECT * 
FROM stranger_things 
WHERE thing = '' OR 1=1 UNION ALL SELECT 1,2,
	CONCAT (username, " ", password)
	FROM users#
\end{lstlisting}

Il risultato della query restituirà l'intera tabella users.

\subsection{Remote Code Execution - (RCE)}

La Remote Code Execution permette di eseguire un qualsiasi comando di sistema così da permettere all'attaccante di avere un controllo completo sulla macchina.

Nel progetto, questa vulnerabilità è stata implementata in una form di ricerca presente nella dashboard, nella Fig. \ref{fig:rce-commandw} è evidenziata dal rettangolo rosso.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.3]{foto/rce-command.png}
	\caption{Form per eseguire la vulenrabilit\`a RCE.}
	\label{fig:rce-commandw}
\end{figure}

Una volta che viene inserito un comando anteceduto da un "\texttt{;}", il server eseguirà innanzitutto il comando di listing dei file, e successivamente quello passato in input. Infatti in Unix il carattere "\texttt{;}" separa comandi differenti che vengono eseguiti sequenzialmente. In figura (Fig. \ref{fig:rce-result}) è possibile vedere l'esecuzione del comando \texttt{id} in seguito all'immissione nel form di input della stringa \texttt{; id}.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.3]{foto/rce-result.png}
	\caption{Risultato del comando \textit{; id}.}
	\label{fig:rce-result}
\end{figure} 

\subsection{Cross-Site Scripting - (XSS)}

La vulerabilit\`a \textbf{XSS} colpisce i sisti web dinamici che non fanno sufficenti controlli nelle form. Infatti l'XSS, va a modificare direttamente l'html di una pagina web. Con questo attacco si esegue del codice a lato client cos\`i da poter raccogliere, manipolare, reindirizzare e modificare a lato server le informazioni.